(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ac5e10ee"],{"386d":function(t,e,a){"use strict";var n=a("cb7c"),i=a("83a1"),s=a("5f1b");a("214f")("search",1,(function(t,e,a,r){return[function(a){var n=t(this),i=void 0==a?void 0:a[e];return void 0!==i?i.call(a,n):new RegExp(a)[e](String(n))},function(t){var e=r(a,t,this);if(e.done)return e.value;var l=n(t),c=String(this),o=l.lastIndex;i(o,0)||(l.lastIndex=0);var u=s(l,c);return i(l.lastIndex,o)||(l.lastIndex=o),null===u?-1:u.index}]}))},"6a9c":function(t,e,a){},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"90d7":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-container"},[a("header-sticky",{attrs:{title:"Перевод"}},[a("template",{slot:"prepend"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(e){t.search_visible=!0}}},[t._v("Поиск")])],1)],2),t._v(" "),a("div",{staticStyle:{"min-width":"100%"}},[a("el-select",{staticStyle:{float:"left"},attrs:{size:"mini",placeholder:"Какие ключи показать",clearable:""},model:{value:t.filter.select,callback:function(e){t.$set(t.filter,"select",e)},expression:"filter.select"}},[a("el-option",{attrs:{value:"all",label:"Все переводы"}}),t._v(" "),a("el-option",{attrs:{value:"is_not_translate",label:"Без перевода"}}),t._v(" "),a("el-option",{attrs:{value:"is_translate",label:"Только переведенные"}})],1),t._v(" "),a("el-select",{staticStyle:{float:"left"},attrs:{size:"mini",multiple:"","collapse-tags":"",clearable:""},model:{value:t.filter.language,callback:function(e){t.$set(t.filter,"language",e)},expression:"filter.language"}},t._l(t.languages,(function(t,e){return a("el-option",{key:e,attrs:{label:t.description+" ["+t.name+"]",value:t.id}})})),1),t._v(" "),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:t.getTranslate}},[t._v("Показать")]),t._v(" "),t.filter.model_id?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(){t.filter.model_id=0,t.getTranslate()}}},[t._v("Очистить фильтр по поиску")]):t._e()],1),t._v(" "),a("el-table",{staticStyle:{"padding-bottom":"80px"},attrs:{data:t.translations.data}},t._l(t.languages_c(t.translations.data[0]),(function(e,n){return a("el-table-column",{key:n,attrs:{label:e.id?e.description+" ["+e.name+"]":""},scopedSlots:t._u([{key:"default",fn:function(i){return[e.id?a("div",[a("el-col",{staticStyle:{cursor:"pointer"}},[t.canUserUpdate("0"+e.id)?a("el-popover",{ref:n+"-"+e.id+"-"+i.$index,refInFor:!0,attrs:{placement:"bottom",width:"300",trigger:"click"},on:{show:function(a){t.value=i.row["0"+e.id]}}},[a("div",{staticClass:"container"},[a("div",{staticClass:"el-col-18 my_custom_input"},[a("el-input",{attrs:{type:"textarea",placeholder:"Введите перевод",autofocus:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.keyPress(a,n+"-"+e.id+"-"+i.$index,i.$index,e.id,i.row.id,n)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),a("div",{staticClass:"el-col-5"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Применить",placement:"right"}},[a("el-button",{staticStyle:{width:"100%",margin:"2px 9px 9px 9px"},attrs:{size:"mini",type:"success",icon:"el-icon-check"},on:{click:function(a){return t.saveTranslate(a,n+"-"+e.id+"-"+i.$index,i.$index,e.id,i.row.id,n)}}})],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Отменить",placement:"right"}},[a("el-button",{staticStyle:{width:"100%",margin:"2px 9px 15px 9px"},attrs:{size:"mini",type:"warning",icon:"el-icon-close"},on:{click:function(a){return t.no_saveTranslate(a,n+"-"+e.id+"-"+i.$index)}}})],1),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Очистить ключ",placement:"right"}},[a("el-button",{staticStyle:{width:"100%",margin:"9px","margin-top":"20px"},attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return t.clearTranslate(a,n+"-"+e.id+"-"+i.$index,i.$index,e.id,i.row.id)}}})],1)],1)]),t._v(" "),a("span",{attrs:{slot:"reference"},slot:"reference"},[i.row["0"+e.id]?a("div",{staticClass:"is_translate"},[t._v("\n                  "+t._s(i.row["0"+e.id])+"\n                ")]):a("div",{staticClass:"is_not_translate"})])]):a("div",[i.row["0"+e.id]?a("div",{staticClass:"is_translate_no_update"},[t._v("\n                "+t._s(i.row["0"+e.id])+"\n              ")]):a("div",{staticClass:"is_not_translate_no_update"})])],1)],1):a("div",[a("el-col",[t._v("\n            "+t._s(i.row.name)+"\n          ")]),t._v(" "),a("el-col",{staticStyle:{"font-size":"12px"}},[t._v("\n            "+t._s(i.row.description)+"\n          ")])],1)]}}],null,!0)})})),1),t._v(" "),a("search",{attrs:{filter:["App\\Models\\Translate","App\\Models\\Key","App\\Models\\File"],visible:t.search_visible},on:{"update:visible":function(e){t.search_visible=e},model:function(e){t.filter.model_id=e,t.getTranslate()}}}),t._v(" "),a("div",{staticClass:"el-pagination-container"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":t.translations.meta.current_page,total:t.translations.meta.total,"page-sizes":[5,10,20,40]},on:{"update:currentPage":function(e){return t.$set(t.translations.meta,"current_page",e)},"update:current-page":function(e){return t.$set(t.translations.meta,"current_page",e)},"size-change":function(e){t.query_back.to=e,t.getTranslate()},"current-change":function(e){t.query_back.page=e,t.getTranslate()}}})],1)],1)},i=[],s=(a("a481"),a("75fc")),r=(a("ac6a"),a("456d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-drawer",{attrs:{visible:t.search.visible,size:"50%","wrapper-closable":!1},on:{"update:visible":function(e){return t.$set(t.search,"visible",e)}}},[a("template",{slot:"title"},[a("div",{staticStyle:{width:"100%","text-align":"center"}},[t._v("\n        Поиск\n      ")])]),t._v(" "),a("div",{staticClass:"app-container"},[a("el-input",{attrs:{clearable:"",size:"mini",placeholder:"Начните вводить для поиска"},model:{value:t.search.text,callback:function(e){t.$set(t.search,"text",e)},expression:"search.text"}},[a("template",{slot:"append"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:function(e){return t.startSearch(t.search.text)}}})],1)],2),t._v(" "),a("div",{staticStyle:{"overflow-y":"scroll",height:"calc(100vh - 200px)"}},[a("el-table",{attrs:{data:t.search.data,"empty-text":"Ничего не найдено"},on:{"cell-click":t.clickSearch}},[a("el-table-column",{attrs:{width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("svg-icon",{attrs:{"icon-class":t.icon(n)}})]}}])}),t._v(" "),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-col",{staticStyle:{cursor:"pointer"}},[t._v("\n                "+t._s(t.text(n))+"\n              ")])]}}])})],1)],1)],1)],2)],1)}),l=[],c=(a("c5f6"),a("7f7f"),a("386d"),a("0a66")),o={name:"Search",props:{visible:{type:Boolean,default:function(){return!1}},router:{type:Boolean,default:function(){return!1}},filter:{type:Array,default:function(){return[]}},language:{type:Array,default:function(){return[]}}},data:function(){return{search:{text:"",visible:!1,data:[]}}},watch:{"search.visible":function(t){this.$emit("update:visible",t)},visible:function(t){this.search.visible=this.visible}},created:function(){this.search.visible=this.visible},methods:{clickSearch:function(t){var e=t.id;this.search.visible=!1,this.$emit("model",e)},icon:function(t){if(t.model&&t.model.file_type)return 0===t.model.is_file?"folder":["php","js","json","env"][t.model.file_type-1];var e={"App\\Models\\Translate":"language","App\\Models\\File":"folder","App\\Models\\Key":"keys","App\\User":"driver"};return e[t.entity]},text:function(t){if(t.model&&t.model.name)return t.model.description?"[".concat(t.model.name,"] ").concat(t.model.description):t.model.email?"".concat(t.model.name," [").concat(t.model.email,"] "):"".concat(t.model.name);if("App\\Models\\Translate"===t.entity){if(Number(t.language_id)>0)return t.model[t.language_id];var e=Object.keys(t.model).filter((function(t){return Number(t)&&t})).map((function(e){return t.model[e]})).join(" ");if(e.replace(/\s/gm,"").length)return e}return"~ "+t.searchable},startSearch:function(){var t=this;Object(c["e"])("search",{search:this.search.text,filter:this.filter}).then((function(e){t.search.data=e.data||[]}))}}},u=o,d=a("2877"),f=Object(d["a"])(u,r,l,!1,null,"6977fb58",null),p=f.exports,v=a("9e13"),h={name:"Translate",components:{Search:p},data:function(){return{query_back:{to:5,page:1},filter:{select:"",language:[],model_id:0},show_name_keys:!1,search_visible:!1,translations:{data:[],meta:{current_page:1,total:0}},languages:[],value:"",loading:!0}},watch:{filter:v["b"]},query:function(t){this.filter=Object.assign(this.filter,t)},created:function(){var t=this;Object(c["b"])("language").then((function(e){t.languages=e.data||[],t.filter.language.length<1&&(t.filter.language=t.languages.map((function(t){return t.id}))),t.getTranslate()}))},methods:{languages_c:function(t){if(t){var e=Object.keys(t).map((function(t){return parseInt(t)})).filter((function(t){return t}));return[{id:0}].concat(Object(s["a"])(this.languages.filter((function(t){return e.indexOf(t.id)>=0}))))}return[{id:0}].concat(Object(s["a"])(this.languages))},canUserUpdate:function(t){return!!this.$store.getters.access.root||!!(this.$store.getters.access&&this.$store.getters.access.translate&&this.$store.getters.access.translate.update)&&this.$store.getters.access.translate.update.indexOf(t)>=0},getTranslate:function(){var t=this;this.loading=!0;var e={to:this.query_back.to,page:this.query_back.page,filter:this.filter};Object(c["b"])("translate",e).then((function(e){t.translations=e.data||{},document.querySelector(".el-pagination__total").innerHTML="Кол-во: "+t.translations.meta.total})).finally((function(e){t.loading=!1}))},keyPress:function(t,e,a,n,i,s){var r=this;t.target.blur(),this.$alert("Перенос строки запрещен. Вы хотели сохранить?","Внимание",{confirmButtonText:"OK",type:"error"}).then((function(t){var l=r.clearValue(r.value);r.translations.data[a]["0"+n]=l,r.translations=Object.assign(r.translations),r.sendServer(i,n,l),r.closePopover(e),setTimeout((function(){r.nextTranslate(s,n,a)}),400)}))},saveTranslate:function(t,e,a,n,i,s){var r=this,l=this.clearValue(this.value);this.translations.data[a]["0"+n]=l,this.translations=Object.assign(this.translations),this.sendServer(i,n,l),this.closePopover(e),setTimeout((function(){r.nextTranslate(s,n,a)}),400)},no_saveTranslate:function(t,e){this.value="",this.closePopover(e)},clearTranslate:function(t,e,a,n,i){this.translations.data[a]["0"+n]=null,this.translations=Object.assign(this.translations),this.sendServer(i,n,null),this.closePopover(e)},closePopover:function(t){this.$refs[t]&&1===this.$refs[t].length&&this.$refs[t][0].doClose()},clearValue:function(t){return t.replace(/[~,`,@,\",\',$,%,^,\r,\\,\/,\t,&,\},\{,\[,\]]*/g,"").replace(/[\n]/g," ")},sendServer:function(t,e,a){var n=this;Object(c["f"])("translate",t,{id:t,language_id:e,value:a}).then((function(t){n.$message.success("Сохранено")})).catch((function(t){n.getTranslate()}))},nextTranslate:function(t,e,a){var n=this,i=t+"-"+e+"-"+(a+1);if(this.$refs[i]&&1===this.$refs[i].length){this.$refs[i][0].doShow();try{this.$nextTick((function(){n.$refs[i][0].$children[0].$el.getElementsByTagName("textarea")[0].focus()}))}catch(s){console.error(s)}}}}},g=h,m=(a("eb39"),Object(d["a"])(g,n,i,!1,null,null,null));e["default"]=m.exports},eb39:function(t,e,a){"use strict";var n=a("6a9c"),i=a.n(n);i.a}}]);